---
publishDate: 2025-05-19T00:00:00Z
title: 'Digging into Dynamic Malware Analysis Signals'
image: /images/dynamic-singals.png
excerpt: In this blog, we explore how analyzing run-time behaviors using Dynamic Analyzer data helps uncover abnormal activities in open-source packages. By examining rare network connections and unusual binary executions during package installation, we identify potential malicious actors and suspicious IP addresses. Leveraging tools like VirusTotal and reverse DNS lookups, we demonstrate effective techniques to detect threats early and enhance software supply chain security at scale.
author: SafeDep Team
tags:
  - dynamic-analysis
  - oss
  - malware
  - security
---

# Digging into Dynamic Malware Analysis Signals

We discurssed about our _Dynamic Malware Analyzer_ in the [blog post](/dynamic-analysis-oss-package-at-scale). Dynamic analyzer help in observing real, runtime behaviours and activities for a package, installed in a sandboxed environment. Its complements our Static Analysis system and helps:

- To verify and correlate static analysis findings with actual runtime behavior
- To overcome the limitations of static analysis (which may have false positives and negatives)
- To observe how packages actually behave when executed in a controlled environment
- To identify malicious packages that might evade static code analysis
- To reduce the need for human intervention (manual analysis) over time

Since we started operating this infrastructure, we have already logged nearly `28` _Million_ events, analyzing more then `380,000` packages.

As events are aggregated in such large numbers, we need a way to find **abnormal** activity-in simple terms, we need a way to find the odd one out from the data to quickly spot any bad actors.

We have multiple `Aggregator` tables to store parts of data for efficient distribution analysis.  
Today we are going to see these aggregators:

- Network Connection, IP Aggregator
- Binary execution on install, External Binaries.


### Abnormal Network Connection

While a package is installed, it is bound to make some network connections, especially to `npm` and `pypi` registries, to name a few. But when they make extra connections, that’s something to notice. We log every *IP address* for these connections, and by analyzing the distribution of these *IP addresses*, we can spot anomalies.

You can see the distribution of 624 IP addresses, and their occurrence count below:

<div className="dark:invert dark:brightness-90">
  ![Dynamic Analyzer IP Address Distribution](/images/ip_address.png)
</div>

We can clearly observe that some connections occurred only 1 or 2 times. These connections are very interesting and can be potential malicious behavior.  

A few connections, their `IP` addresses which occurred only 1 time, are:

<div className="dark:invert dark:brightness-90">
  ![Dynamic Analyzer Malicious IP Address](/images/malicious-ip-address-table.png)
</div>

Using [VirusTotal](https://www.virustotal.com/) we can see how IP `167.99.69.236` is classified as malware by multiple sources.

<div className="dark:brightness-90">
  ![Dynamic Analyzer VirusTotal IP examples](/images/virustotal-ip.png)
</div>

It was time to do a `reverse DNS lookup` and find where these connections are going. Although not every IP address can be resolved to a host, due to many reasons, some of the hostnames were:

<div className="dark:invert dark:brightness-90">
  ![Dynamic Analyzer Malicious Host examples](/images/malicious-host.png)
</div>

It’s clear from the data that hostnames like `kbss.felk.cvut.cz`, `oast.online`, `oast.site`, `oast.live`, `mail.sms-system-alert.com` are very suspicious. `OAST` (Out-of-band application security testing) domains are especially suspicious and should not be included in any production application.

After analysis, all `oast.*` domains and `sms-system-alert.com` were found to be malicious, confirmed by `VirusTotal` with multiple sources. `kbss.felk.cvut.cz` is OK.

<div className="dark:brightness-90">
  <figure>
    <figcaption>sms-system-alert.com</figcaption>
    <img src="/images/sms-domain.png" alt="Dynamic Analyzer Malicious Host examples" style="width: 100%;" />
  </figure>
</div>

### Abnormal Binary Execution

Packages introducing external binaries on installing is a common thing. For example, top binaries installed during installation and executed include `esbuild`, `workerd`, `rustc`, `cmake`, `ninja`, `zig`, and many more...

But, this behavior is dangerous. Our `External Binary` distribution is:

<div className="dark:invert dark:brightness-90">
  ![Dynamic Analyzer External Binary Distribution](/images/external-binary.png)
</div>


You will see binaries like `bsc.exe`, `memcmp_invalid_`, `purs.bin`, `test_program`, etc. are very suspicious.  
They can be used to harm the system as soon as the package is installed.

## Conclusion

By analyzing low-frequency network connections and binary executions, we efficiently identify high-risk packages. Future work will correlate these signals with static analysis results to improve detection accuracy.
